{include file="public/layout" /}

<!--<script type="text/javascript" src="/static/js/layer/laydate/laydate.js"></script>-->
<body style="background-color: rgb(255, 255, 255); overflow: auto; cursor: default; -moz-user-select: inherit;">
<script type="text/javascript" src="/static/uploadify/jquery.uploadify.min.js"></script>
<link rel="stylesheet" href="/static/uploadify/uploadify.css">
<div id="append_parent"></div>
<div id="ajaxwaitid"></div>
<div class="page">
	<form class="form-horizontal" id="adminHandle" action="" method="post">
		<!--<input type="hidden" name="act" value="edit">-->
		<!--<input type="hidden" name="admin_id" value="2">-->
		<div class="ncap-form-default">
			<dl class="row">
				<dt class="tit">
					<label for="title"><em>*</em>案例标题:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="title" value="{$infos['title']}" id="title" class="input-txt">
					<input type="hidden" name ='articlesID' value="{$infos['articlesID'] | default =0}">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="team"><em>*</em>团队:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="team" value="{$infos['team']}" id="team" class="input-txt">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="city"><em>*</em>城市:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="city" value="{$infos['city']}" id="city" class="input-txt">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="site"><em>*</em>地址:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="site" value="{$infos['site']}" id="site" class="input-txt">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="title"><em>*</em>内容:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="content" value="{$infos['content']}" id="content" class="input-txt">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="area"><em>*</em>面积:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="area" value="{$infos['area']}" id="area" class="input-txt">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="orderby"><em>*</em>排序:</label>
				</dt>
				<dd class="opt">
					<input type="text" name="orderby" value="{$infos['orderby']}" id="orderby" class="input-txt">
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label><em>*</em>类别:</label>
				</dt>
				<dd class="opt">
					<input type="radio" name="genre" value="1" {if condition="$infos['genre'] == 1"}checked{/if}>设计案例
					<input type="radio" name="genre" value="2" {if condition="$infos['genre'] === 2"}checked{/if}>工程案例
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="typeID"><em>*</em>案例分类</label>
				</dt>
				<dd class="opt">
					<select id="typeID" name="typeID" class="select" style="width: 120px; height: 28px; border: 1px solid #ccc; border-radius: 4px">
						<option value="">请选择...</option>
						{volist name="type" id="vo"}
						<option value="{$vo.typeID}" {if condition="$infos.typeID eq $vo.typeID"}selected{/if} >{$vo.name}</option>
						{/volist}
					</select>
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="userID"><em>*</em>作者</label>
				</dt>
				<dd class="opt">
					<select id="userID" name="userID" class="select" style="width: 120px; height: 28px; border: 1px solid #ccc; border-radius: 4px">
						<option value="">请选择...</option>
						{volist name="user" id="vo"}
						<option value="{$vo.userID}" {if condition="$infos.userID eq $vo.userID"}selected{/if} >{$vo.name}</option>
						{/volist}
					</select>
				</dd>
			</dl>
			<!--<dl class="row">-->
				<!--<dt class="tit">-->
					<!--<label for="img"><em>*</em>分类icon上传:</label>-->
				<!--</dt>-->
				<!--<dd class="opt">-->
					<!--<div>-->
						<!--<input id="thumb_file2" name="license_image" type="file" value="" />-->
					<!--</div>-->
					<!--<div class="jq_uploads_img2">-->
						<!--{if condition="$infos.img"}-->
						<!--<span style="width: 200px; height: 120px; float: left; margin-left: 5px; margin-top: 10px;">-->
                            <!--<img width="200" height="100" src="{$infos.img}"><input id="img" type="hidden" name="img" value="{$infos.img}" />-->
                            <!--<a href="javascript:void(0);">删除</a>-->
                        <!--</span>-->
						<!--{else/}-->
						<!--<input id="img" type="hidden" name="img" value="" />-->
						<!--{/if}-->
					<!--</div>-->
					<!--<script>-->
                        <!--//图片上传-->
                        <!--$("#thumb_file2").uploadify({-->
                            <!--'swf': '/static/uploadify/uploadify.swf?t={$nowtime}',-->
                            <!--'uploader': '{:url("Uploadify/uploadify_oss",array("add_type"=>7))}',-->
<!--//                            'uploader': '{:url("Uploadify/uploadify",array("model"=>"article"))}',-->
                            <!--'cancelImg': '/static/uploadify/uploadify-cancel.png',-->
                            <!--'buttonText': '上传图片',-->
                            <!--'fileTypeExts': '*.gif;*.jpg;*.png;*.jpeg',-->
                            <!--'queueSizeLimit': 1 ,-->
                            <!--'onUploadSuccess': function (file, data, response) {-->
                                <!--data =  data.replace(/\ufeff/g,'');-->
                                <!--var str = '<span style="width: 200px; height: 120px; float: left; margin-left: 5px; margin-top: 10px;"><img width="200" height="100" src="' + data + '"><input type="hidden" id="img" name="img" value="' + data + '" /><a href="javascript:void(0);">删除</a></span>';-->
                                <!--$(".jq_uploads_img2").html(str);-->
                            <!--}-->
                        <!--});-->
                        <!--//图片删除-->
                        <!--$(document).on("click", ".jq_uploads_img2 a", function () {-->
                            <!--var image=$(this).prevAll('input').val();-->
                            <!--$.ajax({-->
                                <!--url : "{:url('uploadify/delete')}",-->
                                <!--type : 'post',-->
                                <!--data : 'image='+image,-->
                                <!--dataType : 'json',-->
                                <!--success : function(res){-->
                                    <!--if(res.status == 0){-->
                                        <!--layer.msg(res.msg,{time:1000});-->
                                        <!--return false;-->
                                    <!--}-->
                                <!--}-->
                            <!--});-->
                            <!--$(this).parent().remove();-->
                        <!--});-->
					<!--</script>-->
				<!--</dd>-->
			<!--</dl>-->
			<dl class="row">
				<dt class="tit">
					<label><em>*</em>图片上传:</label>
				</dt>
				<dd class="opt">
					<dev id="uploadimg"></dev>
					<div id="imgBox"></div>
					<script src="/static/upload.js"></script>
					<script>
                        Upload("imgBox",{
                            path:"/static/upload.php",//请求的地址
                            data:{//往后台传递的参数
                                savePath:"public"
                            },
                            type:"post",//请求方式
                            addBtnName:"添加图片",//添加文件按钮名字
                            //uploadBtnName:"上传图片",//上传文件按钮名字
                            delIcon:"删除",//删除已选择文件的图标或按钮名字
                            //autoUpload: true,//是否自动上传
                            fileNum:5,//上传文件数量
                            fileSize:1,//上传文件的大小，以MB为单位
                            isRepeat:false,//是否可以重复选择文件
                            fileType:['jpg','png','gif','jpeg'],//上传文件的类型
                            showImgList:true,//是否显示缩略图
                            uploadSuccess:function(results){//上传成功的回调
                                if(results.code==100){
                                    results.results.forEach(function(item){
                                        var img = document.createElement("img");
                                        img.src = item;
                                        document.getElementById("uploadimg").appendChild(img);
                                    });
                                    //alert(results.msg)
                                }else{
                                    alert(results.msg)
                                }
                            },
                            uploadError:function(xhr,status){
                                console.log(status)
                                //上传出错的回调
                            },
                            delImgFn:function(parentNode,fileList,fileSrc,filterFile,index){//删除文件前的回调
                                //下方是删除图片的操作，如需弹窗确定，可在本处执行并复制下列代码至确定事件内
                                fileList.splice(index,1);
                                fileSrc.splice(index,1);
                                filterFile.splice(index,1);
                                parentNode.parentNode.removeChild(parentNode);
                                console.log(fileList,fileSrc);
                            }
                        });
					</script>
				</dd>
			</dl>

			<!--<dl class="row">
                <dt class="tit">
                    <label for="second"><em>*</em>关键字:</label>
                </dt>
                <dd class="opt">
                    <input type="text" name="second" value="{$ad_site_info['second'] | default = 3}" id="second" class="input-txt">
                </dd>
            </dl>
            <dl class="row">
                <dt class="tit">
                    <label for="second"><em>*</em>描述:</label>
                </dt>
                <dd class="opt">
                    <textarea name="descrip" id="descrip" value="{$ad_site_info['descrip']}" class="input-txt"></textarea>
                </dd>
            </dl>-->
			<div class="bot"><a href="JavaScript:void(0);" onclick="adsubmit();" class="ncap-btn-big ncap-btn-green" id="submitBtn">确认提交</a></div>
		</div>
	</form>
</div>
</div>
<script>
    $("#sort").keyup(function (){
        var reg = $(this).val().match(/^[1-9]\d*$/);
        var txt = '';
        if (reg != null) {
            txt = reg[0];
        }
        $(this).val(txt);
    })

    function adsubmit(){
        var params = $('#adminHandle').serialize();
        if($('#title').val() == ''){
            layer.msg('标题不能为空');
            return false;
        }else if($('#orderby').val() == ''){
            layer.msg('排序不能为空');
            return false;
        }else if($('#typeID').val() == ''){
            layer.msg('分类不能为空');
            return false;
        }else if($('#content').val() == ''){
            layer.msg('内容不能为空');
            return false;
        }
        $.ajax({
            url:"{:url('cases/case_add')}",
            type:'post',
            data:params,
            dataType:'json',
            success:function(res){
                layer.msg(res.msg,{time:1000},function(){
                    if(res.status == 1){
                        location.href= "{:url('cases/case_add')}";
                    }
                });
            }
        });
    }
</script>
</body>
</html>